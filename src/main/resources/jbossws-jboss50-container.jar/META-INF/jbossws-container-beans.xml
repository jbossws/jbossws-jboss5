<?xml version="1.0" encoding="UTF-8"?>

<deployment xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="urn:jboss:bean-deployer bean-deployer_2_0.xsd"
            xmlns="urn:jboss:bean-deployer:2.0">

   <!-- Locate the single instance of the kernel -->
   <bean name="WSKernelLocator" class="org.jboss.wsf.spi.util.KernelLocator">
      <property name="kernel"><inject bean="jboss.kernel:service=Kernel"/></property>
   </bean>

   <!-- Locate the single instance of the MBeanServer -->
   <bean name="WSMBeanServerLocator" class="org.jboss.wsf.framework.management.MBeanServerLocator">
      <property name="mbeanServer"><inject bean="JMXKernel" property="mbeanServer"/></property>
   </bean>

   <!-- The HTTPServer used by the JAXWS Endpoint API -->
   <bean name="WSHTTPServer" class="org.jboss.wsf.container.jboss50.DeploymentAspectHttpServer"/>

   <!-- The registry for web service endpoints -->
   <bean name="WSEndpointRegistry" class="org.jboss.wsf.framework.management.ManagedEndpointRegistry">
      <property name="mbeanServer"><inject bean="WSMBeanServerLocator" property="mbeanServer"/></property>
   </bean>
   
   <!--   *********************************************************************************************************************
   Main WSFRuntimes.
   -->

   <bean name="WebserviceJSERuntime" class="org.jboss.wsf.container.jboss50.BareWSFRuntime">
      <property name="runtimeName">WebserviceJSERuntime</property>
      <property name="deploymentAspectManager"><inject bean="WSDeploymentAspectManagerJSE"/></property>
   </bean>

   <bean name="WebserviceEJBRuntime" class="org.jboss.wsf.container.jboss50.BareWSFRuntime">
      <property name="runtimeName">WebserviceEJBRuntime</property>
      <property name="deploymentAspectManager"><inject bean="WSDeploymentAspectManagerEJB"/></property>
   </bean>

   <bean name="EndpointAPIRuntime" class="org.jboss.wsf.container.jboss50.BareWSFRuntime">
      <property name="runtimeName">EndpointAPIRuntime</property>
      <property name="deploymentAspectManager"><inject bean="WSDeploymentAspectManagerEndpointAPI"/></property>
   </bean>


   <!--
   *********************************************************************************************************************
   Deployment aspect manager
   -->

   <bean name="WSDeploymentAspectManagerJSE" class="org.jboss.wsf.framework.deployment.DeploymentAspectManagerImpl">
      <property name="name">WSDeploymentAspectManagerJSE</property>
   </bean>
   <bean name="WSDeploymentAspectManagerEJB" class="org.jboss.wsf.framework.deployment.DeploymentAspectManagerImpl">
      <property name="name">WSDeploymentAspectManagerEJB</property>
   </bean>
   <bean name="WSDeploymentAspectManagerEndpointAPI" class="org.jboss.wsf.framework.deployment.DeploymentAspectManagerImpl">
      <property name="name">WSDeploymentAspectManagerEndpointAPI</property>
   </bean>

   <!--
   The container deployment aspects
   -->
   <bean name="WSContainerMetaDataDeploymentAspect" class="org.jboss.wsf.container.jboss50.deployment.metadata.ContainerMetaDataDeploymentAspect">
      <property name="provides">ContainerMetaData, VFSRoot</property>
   </bean>

   <bean name="WSContextRootDeploymentAspect" class="org.jboss.wsf.framework.deployment.BackwardCompatibleContextRootDeploymentAspect">
      <property name="requires">ContainerMetaData</property>
      <property name="provides">ContextRoot</property>
   </bean>

   <bean name="WSEndpointAddressDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointAddressDeploymentAspect">
      <property name="requires">URLPattern</property>
      <property name="provides">EndpointAddress</property>
   </bean>

   <bean name="WSEndpointAPIDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointAPIDeploymentAspect">
      <property name="provides">ContainerMetaData, RuntimeLoader, URLPattern, VFSRoot</property>
   </bean>

   <bean name="WSEndpointHandlerDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointHandlerDeploymentAspect">
      <property name="requires">ContainerMetaData</property>
      <property name="provides">ContainerEndpointHandler</property>
   </bean>

   <bean name="WSEndpointLifecycleDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointLifecycleDeploymentAspect">
      <property name="requires">LAST_DEPLOYMENT_ASPECT</property>
   </bean>

   <bean name="WSEndpointMetricsDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointMetricsDeploymentAspect">
      <property name="provides">EndpointMetrics</property>
   </bean>

   <bean name="WSEndpointNameDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointNameDeploymentAspect">
      <property name="requires">URLPattern</property>
      <property name="provides">EndpointName</property>
   </bean>

   <bean name="WSEndpointRegistryDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointRegistryDeploymentAspect">
      <property name="requires">EndpointName</property>
      <property name="provides">RegisteredEndpoint</property>
   </bean>

   <bean name="WSModifyWebMetaDataDeploymentAspect" class="org.jboss.wsf.container.jboss50.deployment.tomcat.ModifyWebMetaDataDeploymentAspect">
      <property name="requires">ContextProperties, StackDescriptor</property>
   </bean>

   <bean name="WSRuntimeLoaderDeploymentAspect" class="org.jboss.wsf.container.jboss50.deployment.RuntimeLoaderDeploymentAspect">
      <property name="requires">ContainerMetaData</property>
      <property name="provides">RuntimeLoader</property>
   </bean>

   <bean name="WSURLPatternDeploymentAspect" class="org.jboss.wsf.framework.deployment.BackwardCompatibleURLPatternDeploymentAspect">
      <property name="requires">ContextRoot, ContainerMetaData</property>
      <property name="provides">URLPattern</property>
   </bean>

   <bean name="WSWebAppDeploymentAspect" class="org.jboss.wsf.container.jboss50.WebAppDeploymentAspect">
      <property name="requires">WebMetaData, ContextProperties</property>
      <property name="webXMLRewriter"><inject bean="WSWebXMLRewriter"/></property>
      <property name="mainDeployer"><inject bean="MainDeployer"/></property>
   </bean>

   <bean name="WSWebAppGeneratorDeploymentAspect" class="org.jboss.wsf.container.jboss50.WebApp50GeneratorDeploymentAspect">
      <property name="requires">URLPattern</property>
      <property name="provides">WebMetaData</property>
      <property name="securityHandlerEJB21"><inject bean="WSSecurityHandlerEJB21"/></property>
      <property name="securityHandlerEJB3"><inject bean="WSSecurityHandlerEJB3"/></property>
   </bean>

   <!-- Deployment aspect helper beans -->
   <bean name="WSSecurityHandlerEJB21" class="org.jboss.wsf.container.jboss50.deployment.tomcat.SecurityHandlerEJB21"/>
   <bean name="WSSecurityHandlerEJB3" class="org.jboss.wsf.container.jboss50.deployment.tomcat.SecurityHandlerEJB3"/>
   <bean name="WSWebAppDesciptorModifier" class="org.jboss.wsf.container.jboss50.DefaultWebAppDesciptorModifierImpl"/>
   <bean name="WSWebXMLRewriter" class="org.jboss.wsf.container.jboss50.WebXMLRewriterImpl">
      <property name="desciptorModifier"><inject bean="WSWebAppDesciptorModifier"/></property>
   </bean>

   <!-- Deployment aspect installers -->

   <!-- Phase 1 -->
   <bean name="WSDeploymentAspectInstallerJSE" class="org.jboss.wsf.framework.deployment.DeploymentAspectInstaller">
      <property name="manager"><inject bean="WSDeploymentAspectManagerJSE"/></property>
      <property name="sortAspectsOnCreate">false</property>
      <property name="aspects">
         <set class="java.util.HashSet" elementClass="org.jboss.wsf.spi.deployment.DeploymentAspect">
            <inject bean="WSContainerMetaDataDeploymentAspect"/>
            <inject bean="WSContextRootDeploymentAspect"/>
            <inject bean="WSEndpointAddressDeploymentAspect"/>
            <inject bean="WSEndpointHandlerDeploymentAspect"/>
            <inject bean="WSEndpointMetricsDeploymentAspect"/>
            <inject bean="WSEndpointNameDeploymentAspect"/>
            <inject bean="WSEndpointRegistryDeploymentAspect"/>
            <inject bean="WSModifyWebMetaDataDeploymentAspect"/>
            <inject bean="WSURLPatternDeploymentAspect"/>

            <!-- Phase2 -->
            <inject bean="WSEndpointLifecycleDeploymentAspect"/>
            <inject bean="WSRuntimeLoaderDeploymentAspect"/>
         </set>
      </property>
   </bean>


   <bean name="WSDeploymentAspectInstallerEJB" class="org.jboss.wsf.framework.deployment.DeploymentAspectInstaller">
      <property name="manager"><inject bean="WSDeploymentAspectManagerEJB"/></property>
      <property name="sortAspectsOnCreate">false</property>
      <property name="aspects">
         <set class="java.util.HashSet" elementClass="org.jboss.wsf.spi.deployment.DeploymentAspect">
            <inject bean="WSContainerMetaDataDeploymentAspect"/>
            <inject bean="WSContextRootDeploymentAspect"/>
            <inject bean="WSEndpointAddressDeploymentAspect"/>
            <inject bean="WSEndpointHandlerDeploymentAspect"/>
            <inject bean="WSEndpointLifecycleDeploymentAspect"/>
            <inject bean="WSEndpointMetricsDeploymentAspect"/>
            <inject bean="WSEndpointNameDeploymentAspect"/>
            <inject bean="WSEndpointRegistryDeploymentAspect"/>
            <inject bean="WSURLPatternDeploymentAspect"/>
            <inject bean="WSRuntimeLoaderDeploymentAspect"/>
            <inject bean="WSWebAppDeploymentAspect"/>
            <inject bean="WSWebAppGeneratorDeploymentAspect"/>
         </set>
      </property>
   </bean>

   <bean name="WSDeploymentAspectInstallerEndpointAPI" class="org.jboss.wsf.framework.deployment.DeploymentAspectInstaller">
      <property name="manager"><inject bean="WSDeploymentAspectManagerEndpointAPI"/></property>
      <property name="sortAspectsOnCreate">false</property>
      <property name="aspects">
         <set class="java.util.HashSet" elementClass="org.jboss.wsf.spi.deployment.DeploymentAspect">
            <inject bean="WSEndpointAPIDeploymentAspect"/>
            <inject bean="WSEndpointAddressDeploymentAspect"/>
            <inject bean="WSEndpointHandlerDeploymentAspect"/>
            <inject bean="WSEndpointLifecycleDeploymentAspect"/>
            <inject bean="WSEndpointMetricsDeploymentAspect"/>
            <inject bean="WSEndpointNameDeploymentAspect"/>
            <inject bean="WSEndpointRegistryDeploymentAspect"/>
            <inject bean="WSWebAppDeploymentAspect"/>
            <inject bean="WSWebAppGeneratorDeploymentAspect"/>
         </set>
      </property>
   </bean>

</deployment>
